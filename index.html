<html>
  <head>
    <title>Outlook</title>
	<meta charset="utf-8">
	<link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/1.0/fabric.css">
    <link rel="stylesheet" href="https://appsforoffice.microsoft.com/fabric/1.0/fabric.components.css">
    <script>
      window.onload = function(){
        var user,pass;

        function submitFile(event) {
          event.preventDefault();
          var formData = new FormData();

          formData.append('file', document.getElementById("file").files[0]);
          console.log('submitFile', formData);

          fetch('http://localhost:8000/postCalendarEvent', {
            method: 'POST',
            credentials: 'same-origin',
            body: formData
          })
          .then(res => {
            console.log(res);
          })
          .catch(err => {
            console.log(err);
          });
        }

        document.getElementById('sendFile').addEventListener('submit', submitFile);
      }
    </script>
  </head>
  <body>
    <form action="" id="sendFile">
	    <div class="ms-Grid-col ms-u-mdPush1 ms-u-md9 ms-u-lgPush1 ms-u-lg6">
			<div>
			<h2 class="ms-font-xxl ms-fontWeight-semibold">Welcome to Outlook events creator!</h2>
			<p class="ms-font-xl">You're now connected to Office 365. Choose your file and click the button below to creat your outlook calendar events. </p>
			<div class="ms-TextField">
			   <input type="file" id="file" class="ms-TextField-field" name="File">
			</div>
			<button type="submit" value="Submit" id="send_mail_button" class="ms-Button">
			<span class="ms-Button-label">Creat Events</span>
			</button>
			
			</div>
		</div>
    </form>
  </body>
</html>
